<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Superpoteri / SuperkrÃ¤fte â€“ Mini Test</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#5b4ef0" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<style>
  :root{ --violet:#5b4ef0; --teal:#10b39e; --orange:#f4803c; --bg:#f7f8fb; --ink:#1f2a37; }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;}
  .wrap{max-width:780px;margin:0 auto;padding:16px 14px 120px;}
  .card{background:#fff;border-radius:14px;box-shadow:0 6px 18px rgba(0,0,0,.08);padding:18px 16px;margin:12px 0;}
  h1{font-size:1.5rem;line-height:1.2;margin:12px 0;color:var(--violet)}
  h2{font-size:1.1rem;margin:8px 0;color:#0f172a}
  .lang{display:flex;gap:8px;margin:4px 0 8px}
  .lang button{flex:1;border:0;border-radius:10px;padding:10px;background:#ebedf9;color:#333;font-weight:600}
  .lang button.active{background:var(--violet);color:#fff}
  .modes{display:flex;gap:8px;margin:4px 0 8px}
  .modes button{flex:1;border:0;border-radius:10px;padding:10px;background:#eafaf7;color:#0f766e;font-weight:700}
  .modes button.active{background:var(--teal);color:#fff}
  .q{margin-top:8px}
  .opt{display:grid;grid-template-columns:1fr;gap:8px;margin-top:10px}
  .opt button{border:2px solid #e5e7eb;background:#fff;padding:12px;border-radius:12px;text-align:left;font-weight:600}
  .opt button.sel{border-color:var(--teal);background:#ecfdf5}
  .progress{height:8px;background:#eef2ff;border-radius:999px;overflow:hidden;margin:12px 0}
  .progress>span{display:block;height:100%;background:linear-gradient(90deg,var(--violet),var(--teal));width:0}
  .muted{color:#64748b;font-size:.92rem}
  .badges{display:flex;gap:8px;flex-wrap:wrap}
  .badge{background:#f1f5f9;border:1px solid #e2e8f0;border-radius:10px;padding:8px 10px;font-weight:700}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width:560px){.grid{grid-template-columns:1fr}}
  .footer{position:fixed;left:0;right:0;bottom:0;background:#fff;border-top:1px solid #e5e7eb;padding:10px}
  .footer .bar{max-width:780px;margin:0 auto;display:flex;gap:10px}
  .footer button{flex:1;border:0;border-radius:12px;padding:14px;font-size:1rem;font-weight:800;background:var(--violet);color:#fff}
  .footer button.ghost{background:#eef2ff;color:#333}
  .hide{display:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <div class="lang">
      <button id="btnIT" class="active">ğŸ‡®ğŸ‡¹ Italiano</button>
      <button id="btnDE">ğŸ‡©ğŸ‡ª Deutsch</button>
    </div>
    <div class="modes">
      <button id="btnStep" class="active">â˜ Passoâ€‘passo / Schrittâ€‘fÃ¼râ€‘Schritt</button>
      <button id="btnSingle">â–¦ Schermata singola / Einzelseite</button>
    </div>
    <h1 id="title">Miniâ€‘test: Quali sono i tuoi superpoteri?</h1>
    <p class="muted" id="intro">Rispondi a 6 domande (2â€“3 minuti). Alla fine vedrai le tue aree forti e i percorsi suggeriti. Nessun dato viene salvato.</p>
    <div class="progress"><span id="prog"></span></div>
    <div id="quiz"></div>
  </div>

  <div class="card" id="result" style="display:none">
    <h2 id="resTitle">Risultato</h2>
    <p id="resLead" class="muted">Ecco le tue supercompetenze (top 2) e alcune idee di percorso.</p>
    <div class="badges" id="badges"></div>

    <h2 style="margin-top:16px" id="suggest">Potrebbe piacerti / Das kÃ¶nnte passen</h2>
    <div class="grid" id="paths"></div>

    <p class="muted" style="margin-top:12px" id="brochure">Trovi tutte le opzioni nellâ€™opuscolo <strong>â€œScegli il tuo futuro / Wegweiserâ€</strong> (QR allo stand).</p>
  </div>
</div>

<div class="footer">
  <div class="bar">
    <button id="resetBtn" class="ghost">âŸ² <span id="resetTxt">Ricomincia</span></button>
    <button id="prevBtn" disabled>âŸµ <span id="prevTxt">Indietro</span></button>
    <button id="nextBtn"><span id="nextTxt">Avanti</span> âŸ¶</button>
  </div>
</div>

<script>
const L = {
  it: {
    title: 'Miniâ€‘test: Quali sono i tuoi superpoteri?',
    intro: 'Rispondi a 6 domande (2â€“3 minuti). Alla fine vedrai le tue aree forti e i percorsi suggeriti. Nessun dato viene salvato.',
    prev:'Indietro', next:'Avanti', finish:'Vedi risultato', reset:'Ricomincia',
    result:'Risultato', lead:'Ecco le tue supercompetenze (top 2) e alcune idee di percorso.',
    paths:'Potrebbe piacerti', brochure:'Trovi tutte le opzioni nellâ€™opuscolo â€œScegli il tuo futuro / Wegweiserâ€ (QR allo stand).',
    mode_step:'Passoâ€‘passo / Schrittâ€‘fÃ¼râ€‘Schritt', mode_single:'Schermata singola / Einzelseite',
    q:[
      {t:'Cosa ti piace fare nel tempo libero?', o:[['Disegnare o creare','CRE'],['Costruire o riparare','TEC'],['Aiutare gli altri','SOC'],['Esperimenti o logica','MINT']]},
      {t:'A scuola ti senti forte quandoâ€¦', o:[['Scrivi, racconti o progetti','CRE'],['Usi strumenti, macchine, tecnologia','TEC'],['Lavori in gruppo','SOC'],['Fai calcoli o esperimenti','MINT']]},
      {t:'Come risolvi un problema?', o:[['Immagino soluzioni nuove','CRE'],['Provo fino a farlo funzionare','TEC'],['Chiedo e confronto idee','SOC'],['Analizzo passo passo','MINT']]},
      {t:'Quale attivitÃ  ti stimola di piÃ¹?', o:[['Ideare un logo o un video','CRE'],['Montare un robot','TEC'],['Organizzare un evento','SOC'],['Scrivere un piccolo programma','MINT']]},
      {t:'Preferisciâ€¦', o:[['Raccontare una storia','CRE'],['Smontare un oggetto','TEC'],['Fare volontariato','SOC'],['Risolvere un puzzle logico','MINT']]},
      {t:'Il feedback che ricevi piÃ¹ spesso Ã¨â€¦', o:[['Sei creativo/a','CRE'],['Sei pratico/a e preciso/a','TEC'],['Sei empatico/a','SOC'],['Sei analitico/a','MINT']]}
    ],
    labels:{CRE:'CreativitÃ ', TEC:'Tecnicoâ€‘pratico', SOC:'Sociale', MINT:'MINT'},
    rec:{CRE:['Liceo artistico','Design & media','Corsi creativi'], TEC:['Istituto tecnico','Formazione professionale','Laboratori'], SOC:['Scienze umane/sociali','Educazione','Servizi alla persona'], MINT:['Liceo scientifico','Informatica','Robotica base']}
  },
  de: {
    title: 'Miniâ€‘Test: Was sind deine SuperkrÃ¤fte?',
    intro: 'Beantworte 6 Fragen (2â€“3 Minuten). Am Ende siehst du deine StÃ¤rkenbereiche und passende Wege. Es werden keine Daten gespeichert.',
    prev:'ZurÃ¼ck', next:'Weiter', finish:'Ergebnis anzeigen', reset:'Neu starten',
    result:'Ergebnis', lead:'Deine Topâ€‘2â€‘SuperkrÃ¤fte und einige passende Bildungswege.',
    paths:'Das kÃ¶nnte passen', brochure:'Alle Optionen findest du im Heft â€Scegli il tuo futuro / Wegweiserâ€œ (QR am Stand).',
    mode_step:'Passoâ€‘passo / Schrittâ€‘fÃ¼râ€‘Schritt', mode_single:'Schermata singola / Einzelseite',
    q:[
      {t:'Was machst du gern in deiner Freizeit?', o:[['Zeichnen oder gestalten','CRE'],['Bauen oder reparieren','TEC'],['Anderen helfen','SOC'],['Experimente oder Logik','MINT']]},
      {t:'In der Schule fÃ¼hlst du dich stark, wennâ€¦', o:[['Du schreibst, erzÃ¤hlst oder entwirfst','CRE'],['Du mit Werkzeugen, Maschinen, Technik arbeitest','TEC'],['Teamarbeit gefragt ist','SOC'],['Du rechnest oder experimentierst','MINT']]},
      {t:'Wie lÃ¶st du Probleme?', o:[['Neue Ideen entwickeln','CRE'],['Ausprobieren bis es klappt','TEC'],['Reden & Ideen vergleichen','SOC'],['Schrittweise analysieren','MINT']]},
      {t:'Welche AktivitÃ¤t motiviert dich am meisten?', o:[['Ein Logo oder Video entwerfen','CRE'],['Einen Roboter zusammenbauen','TEC'],['Ein Event organisieren','SOC'],['Ein kleines Programm schreiben','MINT']]},
      {t:'Du bevorzugstâ€¦', o:[['Eine Geschichte erzÃ¤hlen','CRE'],['Etwas auseinandernehmen','TEC'],['Freiwilligenarbeit','SOC'],['Ein Logikâ€‘Puzzle lÃ¶sen','MINT']]},
      {t:'Welches Feedback bekommst du oft?', o:[['Kreativ','CRE'],['Praktisch & genau','TEC'],['Empathisch','SOC'],['Analytisch','MINT']]}
    ],
    labels:{CRE:'Kreativ', TEC:'Technischâ€‘praktisch', SOC:'Sozial', MINT:'MINT'},
    rec:{CRE:['Kunstgymnasium','Design & Medien','Kreativkurse'], TEC:['Fachoberschule Technik','Berufsbildung','WerkstÃ¤tten'], SOC:['Sozialâ€‘/Humanwissenschaften','PÃ¤dagogik','Dienstleistungen'], MINT:['Naturwissenschaftliches Gymnasium','Informatik','Robotikâ€‘Einstieg']}
  }
};

let lang='it';
let single=false; // single-screen mode toggle
const el = s=>document.querySelector(s);
const quizDiv = el('#quiz');
const prog = el('#prog');
const btnPrev = el('#prevBtn');
const btnNext = el('#nextBtn');
const btnReset = el('#resetBtn');
const btnStep = el('#btnStep');
const btnSingle = el('#btnSingle');
let step = 0; // for step mode
let answers = new Array(6).fill(null);

function setLang(l){ lang=l; document.getElementById('btnIT').classList.toggle('active', l==='it'); document.getElementById('btnDE').classList.toggle('active', l==='de'); render(); }
function setMode(s){ single=s; btnStep.classList.toggle('active', !s); btnSingle.classList.toggle('active', s); render(); }

function render(){
  const T = L[lang];
  el('#title').textContent=T.title;
  el('#intro').textContent=T.intro;
  el('#prevTxt').textContent=T.prev;
  el('#nextTxt').textContent = single? (allAnswered()?T.finish:T.next) : (step===T.q.length-1?T.finish:T.next);
  el('#resetTxt').textContent=T.reset;
  el('#resTitle').textContent=T.result; el('#resLead').textContent=T.lead; el('#suggest').textContent=T.paths; el('#brochure').textContent=T.brochure;
  btnPrev.classList.toggle('hide', single);

  if(single){
    // render all questions
    let html = '';
    T.q.forEach((q,qi)=>{
      html += `<div class="q"><h2>${q.t}</h2><div class="opt" id="opt-${qi}"></div></div>`;
    });
    quizDiv.innerHTML = html;
    T.q.forEach((q,qi)=>{
      const optDiv = document.getElementById('opt-'+qi);
      q.o.forEach((pair,i)=>{
        const b=document.createElement('button');
        b.textContent=pair[0];
        b.className = (answers[qi]===i)?'sel':'';
        b.onclick=()=>{answers[qi]=i; Array.from(optDiv.children).forEach(x=>x.classList.remove('sel')); b.classList.add('sel'); updateProgress(); updateNav();};
        optDiv.appendChild(b);
      });
    });
    updateProgress();
  } else {
    // step-by-step single question
    const q=T.q[step];
    quizDiv.innerHTML = `<div class=\"q\"><h2>${q.t}</h2><div class=\"opt\"></div></div>`;
    const optDiv = quizDiv.querySelector('.opt');
    q.o.forEach((pair,i)=>{
      const b=document.createElement('button');
      b.textContent=pair[0];
      b.className = (answers[step]===i)?'sel':'';
      b.onclick=()=>{answers[step]=i; document.querySelectorAll('.opt button').forEach(x=>x.classList.remove('sel')); b.classList.add('sel'); updateNav();};
      optDiv.appendChild(b);
    });
    const pct = (step/T.q.length)*100; prog.style.width = pct+'%';
    btnPrev.disabled = step===0;
  }
  updateNav();
}

function updateProgress(){
  const T=L[lang];
  const done = answers.filter(a=>a!==null).length;
  const pct = (done/T.q.length)*100; prog.style.width=pct+'%';
}

function allAnswered(){ return answers.every(a=>a!==null); }

function updateNav(){
  const T=L[lang];
  if(single){
    btnNext.disabled = !allAnswered();
  } else {
    const last = step===T.q.length-1;
    btnNext.disabled = (answers[step]===null);
    el('#nextTxt').textContent = last?T.finish:T.next;
  }
}

function compute(){
  const T=L[lang];
  const tally={CRE:0,TEC:0,SOC:0,MINT:0};
  answers.forEach((ans,idx)=>{ const code=T.q[idx].o[ans][1]; tally[code]++; });
  const sorted = Object.entries(tally).sort((a,b)=>b[1]-a[1]);
  const top2 = sorted.slice(0,2).map(x=>x[0]);
  const bdiv = document.getElementById('badges'); bdiv.innerHTML='';
  top2.forEach(k=>{ const s=document.createElement('span'); s.className='badge'; s.textContent=`${T.labels[k]} â€¢ ${tally[k]} / 6`; bdiv.appendChild(s); });
  const g=document.getElementById('paths'); g.innerHTML='';
  top2.forEach(k=>{ const col=document.createElement('div'); col.className='card'; const h=document.createElement('h3'); h.textContent=T.labels[k]; h.style.marginTop='0'; const ul=document.createElement('ul'); T.rec[k].forEach(t=>{ const li=document.createElement('li'); li.textContent=t; ul.appendChild(li); }); col.appendChild(h); col.appendChild(ul); g.appendChild(col); });
  document.getElementById('result').style.display='block';
  window.scrollTo({top:document.body.scrollHeight, behavior:'smooth'});
}

function resetAll(){ answers = new Array(6).fill(null); step=0; document.getElementById('result').style.display='none'; prog.style.width='0%'; render(); }

// buttons
btnPrev.onclick=()=>{ if(!single && step>0){ step--; render(); }}
btnNext.onclick=()=>{ const T=L[lang]; if(single){ compute(); } else { if(step < T.q.length-1){ step++; render(); } else { prog.style.width='100%'; compute(); } } };
btnReset.onclick=resetAll;

// language & mode toggles
document.getElementById('btnIT').onclick=()=>setLang('it');
document.getElementById('btnDE').onclick=()=>setLang('de');
btnStep.onclick=()=>setMode(false);
btnSingle.onclick=()=>setMode(true);

// Register service worker for PWA (requires HTTPS or localhost)
if ('serviceWorker' in navigator) {
  window.addEventListener('load', ()=>{
    navigator.serviceWorker.register('./sw.js').catch(console.error);
  });
}

render();
</script>
</body>
</html>